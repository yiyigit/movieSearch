{"ast":null,"code":"var _jsxFileName = \"/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/src/Result.jsx\";\nimport React, { useContext, useState, useEffect } from \"react\";\nimport { MovieContext, ErrorContext } from \"./context\";\nimport errors from \"./errors\";\nimport Recommendation from \"./Recommendation\";\nimport { fetchDetail, convertImdbIdtoId, fetchCommentsFromServer, sendCommentToServer } from \"./service\";\nimport unavailablePic from \"./unavailable.jpg\";\n\nconst Result = () => {\n  const [movieState, setMovieState] = useContext(MovieContext);\n  const [setError] = useContext(ErrorContext);\n  const [comment, setComment] = useState(\"\");\n  const [myComment, setMyComment] = useState(\"\");\n  useEffect(() => {\n    window.scrollTo(0, 0);\n\n    if (movieState.id) {\n      setComment(\"\");\n      getDetail(movieState.id);\n    } else {\n      convertImdbIdtoId(movieState.imdbID).then(json => {\n        if (json.movie_results.length === 0) {\n          throw new Error(\"LACK_KEYWORD\");\n        } else {\n          const id = json.movie_results[0].id;\n          setMovieState({ ...movieState,\n            id: id\n          });\n          setComment(\"\");\n          setError(\"\");\n        }\n      }).catch(err => {\n        setError(errors[err.error || err.message || \"DEFAULT\"]);\n      });\n    }\n  }, [movieState.id, movieState.imdbID]);\n\n  const getDetail = id => {\n    const imgURL = \"https://image.tmdb.org/t/p/w500/\";\n    return fetchDetail(id).then(json => {\n      setMovieState({\n        Title: json.title,\n        Year: json.release_date,\n        imdbID: json.imdb_id,\n        id: json.id,\n        overview: json.overview,\n        PosterUrl: imgURL + json.poster_path\n      });\n      fetchCommentsFromServer(json.id).then(json => {\n        setMyComment(json.comment);\n      });\n      setError(\"\");\n    }).catch(err => {\n      setError(errors[err.error || err || \"DEFAULT\"]);\n    });\n  };\n\n  const handleInput = e => {\n    setComment(e.target.value);\n  };\n\n  const sendComment = e => {\n    e.preventDefault();\n    sendCommentToServer(movieState.id, comment).then(json => {});\n    setComment(\"\");\n  };\n\n  const deleteCommentFromServer = () => {\n    console.log(\"delete\");\n  };\n\n  let result_poster;\n  {\n    if (!movieState.PosterUrl || movieState.PosterUrl === \"https://image.tmdb.org/t/p/w500/N/A\") {\n      result_poster = /*#__PURE__*/React.createElement(\"img\", {\n        src: unavailablePic,\n        alt: \"poster unavailable\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 23\n        }\n      });\n    } else {\n      result_poster = /*#__PURE__*/React.createElement(\"img\", {\n        src: movieState.PosterUrl,\n        alt: \"poster\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 23\n        }\n      });\n    }\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"result-detail\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 11\n    }\n  }, \" Title: \", movieState.Title, \" \"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"time\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, \" Year: \", movieState.Year, \" \"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"overview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, \" Overview: \", movieState.overview), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, \"My comment:\", myComment), \" \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: deleteCommentFromServer,\n    disabled: !myComment,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 41\n    }\n  }, \"delete\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: e => sendComment(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, \"New Comment:\", /*#__PURE__*/React.createElement(\"input\", {\n    value: comment,\n    onChange: e => handleInput(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }, \"add/update\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"img-detail\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  }, result_poster)), /*#__PURE__*/React.createElement(Recommendation, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Result;","map":{"version":3,"sources":["/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/src/Result.jsx"],"names":["React","useContext","useState","useEffect","MovieContext","ErrorContext","errors","Recommendation","fetchDetail","convertImdbIdtoId","fetchCommentsFromServer","sendCommentToServer","unavailablePic","Result","movieState","setMovieState","setError","comment","setComment","myComment","setMyComment","window","scrollTo","id","getDetail","imdbID","then","json","movie_results","length","Error","catch","err","error","message","imgURL","Title","title","Year","release_date","imdb_id","overview","PosterUrl","poster_path","handleInput","e","target","value","sendComment","preventDefault","deleteCommentFromServer","console","log","result_poster"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\nimport { MovieContext, ErrorContext } from \"./context\";\nimport errors from \"./errors\";\nimport Recommendation from \"./Recommendation\";\nimport {\n  fetchDetail,\n  convertImdbIdtoId,\n  fetchCommentsFromServer,\n  sendCommentToServer,\n} from \"./service\";\nimport unavailablePic from \"./unavailable.jpg\";\n\nconst Result = () => {\n  const [movieState, setMovieState] = useContext(MovieContext);\n  const [setError] = useContext(ErrorContext);\n  const [comment, setComment] = useState(\"\");\n  const [myComment, setMyComment] = useState(\"\");\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n    if (movieState.id) {\n      setComment(\"\");\n      getDetail(movieState.id);\n    } else {\n      convertImdbIdtoId(movieState.imdbID)\n        .then((json) => {\n          if (json.movie_results.length === 0) {\n            throw new Error(\"LACK_KEYWORD\");\n          } else {\n            const id = json.movie_results[0].id;\n            setMovieState({ ...movieState, id: id });\n            setComment(\"\");\n            setError(\"\");\n          }\n        })\n        .catch((err) => {\n          setError(errors[err.error || err.message || \"DEFAULT\"]);\n        });\n    }\n  }, [movieState.id, movieState.imdbID]);\n\n  const getDetail = (id) => {\n    const imgURL = \"https://image.tmdb.org/t/p/w500/\";\n    return fetchDetail(id)\n      .then((json) => {\n        setMovieState({\n          Title: json.title,\n          Year: json.release_date,\n          imdbID: json.imdb_id,\n          id: json.id,\n          overview: json.overview,\n          PosterUrl: imgURL + json.poster_path,\n        });\n        fetchCommentsFromServer(json.id).then((json) => {\n          setMyComment(json.comment);\n        });\n\n        setError(\"\");\n      })\n      .catch((err) => {\n        setError(errors[err.error || err || \"DEFAULT\"]);\n      });\n  };\n\n  const handleInput = (e) => {\n    setComment(e.target.value);\n  };\n  const sendComment = (e) => {\n    e.preventDefault();\n    sendCommentToServer(movieState.id, comment).then((json) => {});\n    setComment(\"\");\n  };\n\n  const deleteCommentFromServer = () => {\n    console.log(\"delete\");\n  }\n  let result_poster;\n  {\n    if (\n      !movieState.PosterUrl ||\n      movieState.PosterUrl === \"https://image.tmdb.org/t/p/w500/N/A\"\n    ) {\n      result_poster = <img src={unavailablePic} alt=\"poster unavailable\" />;\n    } else {\n      result_poster = <img src={movieState.PosterUrl} alt=\"poster\" />;\n    }\n  }\n  \n\n  return (\n    <div className=\"container\">\n      <div className=\"flex-box\">\n        <div className=\"result-detail\">\n          <p className=\"title\"> Title: {movieState.Title} </p>\n          <p className=\"time\"> Year: {movieState.Year} </p>\n          <p className=\"overview\"> Overview: {movieState.overview}</p>\n          <p>My comment:{myComment}</p> <button onClick={deleteCommentFromServer} disabled={!myComment}>delete</button>\n          <form onSubmit={(e) => sendComment(e)}>\n            <label>\n              New Comment:\n              <input value={comment} onChange={(e) => handleInput(e)}></input>\n            </label>\n            <button type=\"submit\">add/update</button>\n          </form>\n        </div>\n        <div className=\"img-detail\">{result_poster}</div>\n      </div>\n\n      <Recommendation />\n    </div>\n  );\n};\n\nexport default Result;\n"]},"metadata":{},"sourceType":"module"}