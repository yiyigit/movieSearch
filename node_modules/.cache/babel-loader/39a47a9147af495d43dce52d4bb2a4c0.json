{"ast":null,"code":"import _objectSpread from\"/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from\"react\";import{MovieContext,ErrorContext}from\"./context\";import errors from\"./errors\";import{fetchRecommendation,convertImdbIdtoId}from\"./service\";import unavailablePic from\"./unavailable.jpg\";var Recommendation=function Recommendation(){var _useContext=useContext(MovieContext),_useContext2=_slicedToArray(_useContext,2),movieState=_useContext2[0],setMovieState=_useContext2[1];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),recommendationList=_useState2[0],setRecommendationList=_useState2[1];var _useContext3=useContext(ErrorContext),_useContext4=_slicedToArray(_useContext3,1),setError=_useContext4[0];useEffect(function(){if(movieState.id){getRecommendation(movieState.id);setError(\"\");}else{convertImdbIdtoId(movieState.imdbID).then(function(json){var id=json.movie_results[0].id;getRecommendation(id);}).catch(function(err){setError(errors[err.error||\"DEFAULT\"]);});}},[movieState.imdbID,movieState.id]);var getRecommendation=function getRecommendation(id){return fetchRecommendation(id).then(function(json){setRecommendationList(json.results.slice(0,3));setError(\"\");}).catch(function(err){setError(errors[err.error||\"DEFAULT\"]);});;};var searchById=function searchById(id){setMovieState(_objectSpread({},movieState,{id:id}));};var imgURL=\"https://image.tmdb.org/t/p/w500/\";var recommendationArray=recommendationList.map(function(movie){var introduction;if(movie.poster_path){introduction=/*#__PURE__*/React.createElement(\"img\",{src:imgURL+movie.poster_path,className:\"clickable\",onClick:function onClick(){return searchById(movie.id);},alt:\"poster\"});}else{introduction=/*#__PURE__*/React.createElement(\"img\",{src:unavailablePic,alt:\"poster unavailable\",className:\"clickable\",onClick:function onClick(){return searchById(movie.id);}});}return/*#__PURE__*/React.createElement(\"li\",{key:recommendationList.indexOf(movie)},/*#__PURE__*/React.createElement(\"p\",{className:\"clickable\",onClick:function onClick(){return searchById(movie.id);}},movie.title),/*#__PURE__*/React.createElement(\"p\",{className:\"time\"},\" \",movie.release_date,\" \"),/*#__PURE__*/React.createElement(\"p\",{className:\"rating\"},\" Rating: \",movie.vote_average,\" \"),introduction,/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return searchById(movie.id);}},\" details\")));});return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Recommendation according to \",/*#__PURE__*/React.createElement(\"span\",{className:\"highlight-title\"},movieState.Title)),/*#__PURE__*/React.createElement(\"ul\",{className:\"recommendation\"},recommendationArray));};export default Recommendation;","map":{"version":3,"sources":["/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/src/Recommendation.jsx"],"names":["React","useState","useContext","useEffect","MovieContext","ErrorContext","errors","fetchRecommendation","convertImdbIdtoId","unavailablePic","Recommendation","movieState","setMovieState","recommendationList","setRecommendationList","setError","id","getRecommendation","imdbID","then","json","movie_results","catch","err","error","results","slice","searchById","imgURL","recommendationArray","map","movie","introduction","poster_path","indexOf","title","release_date","vote_average","Title"],"mappings":"6WAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,UAA1B,CAAsCC,SAAtC,KAAuD,OAAvD,CACA,OAASC,YAAT,CAAuBC,YAAvB,KAA2C,WAA3C,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,OAASC,mBAAT,CAA8BC,iBAA9B,KAAuD,WAAvD,CACA,MAAOC,CAAAA,cAAP,KAA2B,mBAA3B,CAEA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,iBACUR,UAAU,CAACE,YAAD,CADpB,4CACnBO,UADmB,iBACPC,aADO,+BAEyBX,QAAQ,CAAC,EAAD,CAFjC,wCAEpBY,kBAFoB,eAEAC,qBAFA,gCAGRZ,UAAU,CAACG,YAAD,CAHF,6CAGpBU,QAHoB,iBAK3BZ,SAAS,CAAC,UAAM,CACd,GAAIQ,UAAU,CAACK,EAAf,CAAmB,CACjBC,iBAAiB,CAACN,UAAU,CAACK,EAAZ,CAAjB,CACAD,QAAQ,CAAC,EAAD,CAAR,CACD,CAHD,IAGO,CACLP,iBAAiB,CAACG,UAAU,CAACO,MAAZ,CAAjB,CACGC,IADH,CACQ,SAACC,IAAD,CAAU,CACd,GAAMJ,CAAAA,EAAE,CAAGI,IAAI,CAACC,aAAL,CAAmB,CAAnB,EAAsBL,EAAjC,CACAC,iBAAiB,CAACD,EAAD,CAAjB,CACD,CAJH,EAKGM,KALH,CAKS,SAACC,GAAD,CAAS,CACdR,QAAQ,CAACT,MAAM,CAACiB,GAAG,CAACC,KAAJ,EAAa,SAAd,CAAP,CAAR,CACD,CAPH,EAQD,CACF,CAdQ,CAcN,CAACb,UAAU,CAACO,MAAZ,CAAoBP,UAAU,CAACK,EAA/B,CAdM,CAAT,CAgBA,GAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACD,EAAD,CAAQ,CAChC,MAAOT,CAAAA,mBAAmB,CAACS,EAAD,CAAnB,CACJG,IADI,CACC,SAACC,IAAD,CAAU,CACdN,qBAAqB,CAACM,IAAI,CAACK,OAAL,CAAaC,KAAb,CAAmB,CAAnB,CAAsB,CAAtB,CAAD,CAArB,CACAX,QAAQ,CAAC,EAAD,CAAR,CACD,CAJI,EAKJO,KALI,CAKE,SAACC,GAAD,CAAS,CACdR,QAAQ,CAACT,MAAM,CAACiB,GAAG,CAACC,KAAJ,EAAa,SAAd,CAAP,CAAR,CACD,CAPI,CAAP,CAOK,CACN,CATD,CAUA,GAAMG,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACX,EAAD,CAAQ,CACzBJ,aAAa,kBAAMD,UAAN,EAAkBK,EAAE,CAAEA,EAAtB,GAAb,CACD,CAFD,CAIA,GAAMY,CAAAA,MAAM,CAAG,kCAAf,CACA,GAAMC,CAAAA,mBAAmB,CAAGhB,kBAAkB,CAACiB,GAAnB,CAAuB,SAACC,KAAD,CAAW,CAC5D,GAAIC,CAAAA,YAAJ,CACA,GAAID,KAAK,CAACE,WAAV,CAAuB,CACrBD,YAAY,cACV,2BACE,GAAG,CAAEJ,MAAM,CAAGG,KAAK,CAACE,WADtB,CAEE,SAAS,CAAC,WAFZ,CAGE,OAAO,CAAE,yBAAMN,CAAAA,UAAU,CAACI,KAAK,CAACf,EAAP,CAAhB,EAHX,CAIE,GAAG,CAAC,QAJN,EADF,CAQD,CATD,IASO,CACLgB,YAAY,cACV,2BACE,GAAG,CAAEvB,cADP,CAEE,GAAG,CAAC,oBAFN,CAGE,SAAS,CAAC,WAHZ,CAIE,OAAO,CAAE,yBAAMkB,CAAAA,UAAU,CAACI,KAAK,CAACf,EAAP,CAAhB,EAJX,EADF,CAQD,CACD,mBACE,0BAAI,GAAG,CAAEH,kBAAkB,CAACqB,OAAnB,CAA2BH,KAA3B,CAAT,eACE,yBAAG,SAAS,CAAC,WAAb,CAAyB,OAAO,CAAE,yBAAMJ,CAAAA,UAAU,CAACI,KAAK,CAACf,EAAP,CAAhB,EAAlC,EACGe,KAAK,CAACI,KADT,CADF,cAIE,yBAAG,SAAS,CAAC,MAAb,MAAsBJ,KAAK,CAACK,YAA5B,KAJF,cAKE,yBAAG,SAAS,CAAC,QAAb,cAAgCL,KAAK,CAACM,YAAtC,KALF,CAMGL,YANH,cAOE,0CACE,8BAAQ,OAAO,CAAE,yBAAML,CAAAA,UAAU,CAACI,KAAK,CAACf,EAAP,CAAhB,EAAjB,aADF,CAPF,CADF,CAaD,CAlC2B,CAA5B,CAoCA,mBACE,4CACE,0EAC8B,4BAAM,SAAS,CAAC,iBAAhB,EAAmCL,UAAU,CAAC2B,KAA9C,CAD9B,CADF,cAIE,0BAAI,SAAS,CAAC,gBAAd,EAAgCT,mBAAhC,CAJF,CADF,CAQD,CAhFD,CAkFA,cAAenB,CAAAA,cAAf","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\nimport { MovieContext, ErrorContext } from \"./context\";\nimport errors from \"./errors\";\nimport { fetchRecommendation, convertImdbIdtoId } from \"./service\";\nimport unavailablePic from \"./unavailable.jpg\";\n\nconst Recommendation = () => {\n  const [ movieState, setMovieState] = useContext(MovieContext);\n  const [recommendationList, setRecommendationList] = useState([]);\n  const [setError] = useContext(ErrorContext);\n\n  useEffect(() => {\n    if (movieState.id) {\n      getRecommendation(movieState.id);\n      setError(\"\");\n    } else {\n      convertImdbIdtoId(movieState.imdbID)\n        .then((json) => {\n          const id = json.movie_results[0].id;\n          getRecommendation(id);\n        })\n        .catch((err) => {\n          setError(errors[err.error || \"DEFAULT\"]);\n        });\n    }\n  }, [movieState.imdbID, movieState.id]);\n\n  const getRecommendation = (id) => {\n    return fetchRecommendation(id)\n      .then((json) => {\n        setRecommendationList(json.results.slice(0, 3));\n        setError(\"\");\n      })\n      .catch((err) => {\n        setError(errors[err.error || \"DEFAULT\"]);\n      });;\n  };\n  const searchById = (id) => {\n    setMovieState({ ...movieState, id: id });\n  };\n\n  const imgURL = \"https://image.tmdb.org/t/p/w500/\";\n  const recommendationArray = recommendationList.map((movie) => {\n    let introduction;\n    if (movie.poster_path) {\n      introduction = (\n        <img\n          src={imgURL + movie.poster_path}\n          className=\"clickable\"\n          onClick={() => searchById(movie.id)}\n          alt=\"poster\"\n        />\n      );\n    } else {\n      introduction = (\n        <img\n          src={unavailablePic}\n          alt=\"poster unavailable\"\n          className=\"clickable\"\n          onClick={() => searchById(movie.id)}\n        />\n      );\n    }\n    return (\n      <li key={recommendationList.indexOf(movie)}>\n        <p className=\"clickable\" onClick={() => searchById(movie.id)}>\n          {movie.title}\n        </p>\n        <p className=\"time\"> {movie.release_date} </p>\n        <p className=\"rating\"> Rating: {movie.vote_average} </p>\n        {introduction}\n        <p>\n          <button onClick={() => searchById(movie.id)}> details</button>\n        </p>\n      </li>\n    );\n  });\n\n  return (\n    <div>\n      <h2>\n        Recommendation according to <span className=\"highlight-title\">{movieState.Title}</span>\n      </h2>\n      <ul className=\"recommendation\">{recommendationArray}</ul>\n    </div>\n  );\n};\n\nexport default Recommendation;\n"]},"metadata":{},"sourceType":"module"}