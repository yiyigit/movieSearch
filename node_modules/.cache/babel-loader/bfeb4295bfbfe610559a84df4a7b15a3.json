{"ast":null,"code":"import _objectSpread from\"/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect}from\"react\";import{MovieContext,ErrorContext}from\"./context\";import errors from\"./errors\";import Recommendation from\"./Recommendation\";import{fetchDetail,convertImdbIdtoId,fetchCommentsFromServer,sendCommentToServer,deleteCommentInServer}from\"./service\";import unavailablePic from\"./unavailable.jpg\";var Result=function Result(){var _useContext=useContext(MovieContext),_useContext2=_slicedToArray(_useContext,2),movieState=_useContext2[0],setMovieState=_useContext2[1];var _useContext3=useContext(ErrorContext),_useContext4=_slicedToArray(_useContext3,1),setError=_useContext4[0];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),myComment=_useState4[0],setMyComment=_useState4[1];useEffect(function(){window.scrollTo(0,0);if(movieState.id){setComment(\"\");getDetail(movieState.id);}else{convertImdbIdtoId(movieState.imdbID).then(function(json){if(json.movie_results.length===0){throw new Error(\"LACK_KEYWORD\");}else{var id=json.movie_results[0].id;setMovieState(_objectSpread({},movieState,{id:id}));setComment(\"\");setError(\"\");}}).catch(function(err){setError(errors[err.error||err.message||\"DEFAULT\"]);});}},[movieState.id,movieState.imdbID]);var getDetail=function getDetail(id){var imgURL=\"https://image.tmdb.org/t/p/w500/\";return fetchDetail(id).then(function(json){setMovieState({Title:json.title,Year:json.release_date,imdbID:json.imdb_id,id:json.id,overview:json.overview,PosterUrl:imgURL+json.poster_path});fetchCommentsFromServer(json.id).then(function(json){setMyComment(json.comment);});setError(\"\");}).catch(function(err){setError(errors[err.error||err||\"DEFAULT\"]);});};var handleInput=function handleInput(e){setComment(e.target.value);};var sendComment=function sendComment(e){e.preventDefault();sendCommentToServer(movieState.id,comment).then(function(json){setMyComment(json.comment);setComment(\"\");}).catch(function(err){setError(errors[err.error||err||\"DEFAULT\"]);});};var deleteComment=function deleteComment(){deleteCommentInServer(movieState.id).then(function(json){setMyComment(\"\");}).catch(function(err){setError(errors[err.error||err||\"DEFAULT\"]);});};var result_poster;{if(!movieState.PosterUrl||movieState.PosterUrl===\"https://image.tmdb.org/t/p/w500/N/A\"){result_poster=/*#__PURE__*/React.createElement(\"img\",{src:unavailablePic,alt:\"poster unavailable\"});}else{result_poster=/*#__PURE__*/React.createElement(\"img\",{src:movieState.PosterUrl,alt:\"poster\"});}}return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"result-detail\"},/*#__PURE__*/React.createElement(\"p\",{className:\"title\"},\" Title: \",movieState.Title,\" \"),/*#__PURE__*/React.createElement(\"p\",{className:\"time\"},\" Year: \",movieState.Year,\" \"),/*#__PURE__*/React.createElement(\"p\",{className:\"overview\"},\" \",\"Overview: \",movieState.overview||\"Not Available\"),/*#__PURE__*/React.createElement(\"p\",null,\"My comment:\",myComment),\" \",/*#__PURE__*/React.createElement(\"button\",{onClick:deleteComment,disabled:!myComment},\"delete\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){return sendComment(e);}},/*#__PURE__*/React.createElement(\"label\",null,\"New Comment:\",/*#__PURE__*/React.createElement(\"input\",{value:comment,onChange:function onChange(e){return handleInput(e);}})),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"add/update\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"img-detail\"},result_poster)),/*#__PURE__*/React.createElement(Recommendation,null));};export default Result;","map":{"version":3,"sources":["/Users/yiyizhou/Desktop/NEU/info6250 Web tool/demo/final-project/src/Result.jsx"],"names":["React","useContext","useState","useEffect","MovieContext","ErrorContext","errors","Recommendation","fetchDetail","convertImdbIdtoId","fetchCommentsFromServer","sendCommentToServer","deleteCommentInServer","unavailablePic","Result","movieState","setMovieState","setError","comment","setComment","myComment","setMyComment","window","scrollTo","id","getDetail","imdbID","then","json","movie_results","length","Error","catch","err","error","message","imgURL","Title","title","Year","release_date","imdb_id","overview","PosterUrl","poster_path","handleInput","e","target","value","sendComment","preventDefault","deleteComment","result_poster"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\nimport { MovieContext, ErrorContext } from \"./context\";\nimport errors from \"./errors\";\nimport Recommendation from \"./Recommendation\";\nimport {\n  fetchDetail,\n  convertImdbIdtoId,\n  fetchCommentsFromServer,\n  sendCommentToServer,\n  deleteCommentInServer,\n} from \"./service\";\nimport unavailablePic from \"./unavailable.jpg\";\n\nconst Result = () => {\n  const [movieState, setMovieState] = useContext(MovieContext);\n  const [setError] = useContext(ErrorContext);\n  const [comment, setComment] = useState(\"\");\n  const [myComment, setMyComment] = useState(\"\");\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n    if (movieState.id) {\n      setComment(\"\");\n      getDetail(movieState.id);\n    } else {\n      convertImdbIdtoId(movieState.imdbID)\n        .then((json) => {\n          if (json.movie_results.length === 0) {\n            throw new Error(\"LACK_KEYWORD\");\n          } else {\n            const id = json.movie_results[0].id;\n            setMovieState({ ...movieState, id: id });\n            setComment(\"\");\n            setError(\"\");\n          }\n        })\n        .catch((err) => {\n          setError(errors[err.error || err.message || \"DEFAULT\"]);\n        });\n    }\n  }, [movieState.id, movieState.imdbID]);\n\n  const getDetail = (id) => {\n    const imgURL = \"https://image.tmdb.org/t/p/w500/\";\n    return fetchDetail(id)\n      .then((json) => {\n        setMovieState({\n          Title: json.title,\n          Year: json.release_date,\n          imdbID: json.imdb_id,\n          id: json.id,\n          overview: json.overview,\n          PosterUrl: imgURL + json.poster_path,\n        });\n        fetchCommentsFromServer(json.id).then((json) => {\n          setMyComment(json.comment);\n        });\n\n        setError(\"\");\n      })\n      .catch((err) => {\n        setError(errors[err.error || err || \"DEFAULT\"]);\n      });\n  };\n\n  const handleInput = (e) => {\n    setComment(e.target.value);\n  };\n  const sendComment = (e) => {\n    e.preventDefault();\n    sendCommentToServer(movieState.id, comment)\n      .then((json) => {\n        setMyComment(json.comment);\n        setComment(\"\");\n      })\n      .catch((err) => {\n        setError(errors[err.error || err || \"DEFAULT\"]);\n      });\n  };\n\n  const deleteComment = () => {\n    deleteCommentInServer(movieState.id)\n      .then((json) => {\n        setMyComment(\"\");\n      })\n      .catch((err) => {\n        setError(errors[err.error || err || \"DEFAULT\"]);\n      });\n  };\n  let result_poster;\n  {\n    if (\n      !movieState.PosterUrl ||\n      movieState.PosterUrl === \"https://image.tmdb.org/t/p/w500/N/A\"\n    ) {\n      result_poster = <img src={unavailablePic} alt=\"poster unavailable\" />;\n    } else {\n      result_poster = <img src={movieState.PosterUrl} alt=\"poster\" />;\n    }\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"flex-box\">\n        <div className=\"result-detail\">\n          <p className=\"title\"> Title: {movieState.Title} </p>\n          <p className=\"time\"> Year: {movieState.Year} </p>\n          <p className=\"overview\">\n            {\" \"}\n            Overview: {movieState.overview || \"Not Available\"}\n          </p>\n          <p>My comment:{myComment}</p>{\" \"}\n          <button onClick={deleteComment} disabled={!myComment}>\n            delete\n          </button>\n          <form onSubmit={(e) => sendComment(e)}>\n            <label>\n              New Comment:\n              <input value={comment} onChange={(e) => handleInput(e)}></input>\n            </label>\n            <button type=\"submit\">add/update</button>\n          </form>\n        </div>\n        <div className=\"img-detail\">{result_poster}</div>\n      </div>\n\n      <Recommendation />\n    </div>\n  );\n};\n\nexport default Result;\n"]},"metadata":{},"sourceType":"module"}